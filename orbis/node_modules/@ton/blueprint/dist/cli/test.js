"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.test = exports.argSpec = void 0;
const child_process_1 = require("child_process");
const arg_1 = __importDefault(require("arg"));
const constants_1 = require("./constants");
exports.argSpec = {
    '--gas-report': Boolean,
    '-g': '--gas-report',
};
const test = async (args, ui) => {
    const localArgs = (0, arg_1.default)({
        ...constants_1.helpArgs,
        ...exports.argSpec,
    });
    if (localArgs['--help']) {
        ui.write(constants_1.helpMessages['test']);
        return;
    }
    let testArgs = args._.slice(1); // first argument is `test`, need to get rid of it
    if (localArgs['--gas-report']) {
        testArgs = testArgs.slice(1);
    }
    (0, child_process_1.execSync)(`npm test -- ${testArgs.join(' ')}`, {
        stdio: 'inherit',
        env: {
            ...process.env,
            BENCH_DIFF: localArgs['--gas-report'] ? 'true' : 'false',
        },
    });
};
exports.test = test;
